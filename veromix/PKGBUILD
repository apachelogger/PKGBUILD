pkgname=veromix-git
pkgver=r4.53c5233
pkgrel=1
pkgdesc='PulseAudio mixer for Plasma'
arch=('i686' 'x86_64')
url='https://github.com/blue-shell/veromix'
license=('GPL3')
depends=('kdebindings-python' 'kdebase-workspace' 'python2-pyqt4' 'pulseaudio' 'pyxdg'  'python-gobject' 'python-dbus' 
'python2-dbus')
makedepends=('git' 'kdesdk-dev-scripts')
provides=(veromix)
source=('veromix::git+https://github.com/blue-shell/veromix.git')
md5sums=('SKIP')

pkgver() {
  cd veromix
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  cd veromix
  make DESTDIR=${pkgdir}
  make DESTDIR=${pkgdir} install-plasmoid
}

package() {
  #installation
  mkdir -p ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid/contents/
  mkdir -p ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid/contents/code/veromixcommon

   # Generating bytecode
  cd ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid
  python2 -m compileall .
}
