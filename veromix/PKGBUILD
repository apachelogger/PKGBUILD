pkgname=veromix-git
pkgver=2
pkgrel=1
pkgdesc='PulseAudio mixer for Plasma'
arch=('i686' 'x86_64')
url='https://github.com/blue-shell/veromix'
license=('GPL3')
depends=('kinit-git')
makedepends=('git' 'kdoctools-git')
provides=(veromix)
source=('veromix::git+https://github.com/blue-shell/veromix.git')
md5sums=('SKIP')

pkgver() {
  cd veromix
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  cd veromix
  make DESTDIR=${pkgdir} install
}

package() {
  # For KDE
  rm ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid/contents/icons
  rm ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid/contents/code/veromixcommon
  ln -s -r ${pkgdir}/usr/share/icons ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid/contents/
  ln -s -r ${pkgdir}/usr/share/veromix/common 
  ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid/contents/code/veromixcommon

   # Generating bytecode 
  cd ${pkgdir}/usr/share/apps/plasma/plasmoids/veromix-plasmoid
  python2 -m compileall .
}
